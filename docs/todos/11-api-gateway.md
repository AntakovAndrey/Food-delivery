# TODO: API Gateway

## Общее описание
Единая точка входа для всех клиентских запросов, маршрутизация, балансировка нагрузки, аутентификация.

---

## 1. Настройка проекта

- [ ] Создать проект ASP.NET Core WebAPI
- [ ] Выбрать технологию (Ocelot / YARP)
- [ ] Добавить NuGet пакеты:
  - [ ] Ocelot (или YARP)
  - [ ] Microsoft.AspNetCore.Authentication.JwtBearer
  - [ ] Serilog
  - [ ] Swashbuckle.AspNetCore
  - [ ] Polly (для resilience)
- [ ] Настроить appsettings.json
- [ ] Создать Dockerfile
- [ ] Настроить docker-compose

---

## 2. Конфигурация маршрутизации

- [ ] Настроить routes для всех микросервисов:
  - [ ] Identity Service routes
  - [ ] Restaurant Service routes
  - [ ] Menu Service routes
  - [ ] Cart Service routes
  - [ ] Order Service routes
  - [ ] Delivery Service routes
  - [ ] Payment Service routes
  - [ ] Notification Service routes
  - [ ] Review Service routes
  - [ ] Analytics Service routes
- [ ] Настроить агрегацию запросов (если нужно)
- [ ] Настроить load balancing

---

## 3. Аутентификация и авторизация

- [ ] Настроить JWT валидацию
- [ ] Настроить проверку токенов
- [ ] Настроить перенаправление на Identity Service для аутентификации
- [ ] Настроить проверку ролей
- [ ] Настроить policy-based authorization

---

## 4. Rate Limiting

- [ ] Настроить rate limiting для всех endpoints
- [ ] Настроить разные лимиты для разных пользователей
- [ ] Настроить защиту от DDoS
- [ ] Настроить throttling

---

## 5. Кэширование

- [ ] Настроить кэширование для GET запросов
- [ ] Настроить TTL для кэша
- [ ] Настроить инвалидацию кэша

---

## 6. Логирование и мониторинг

- [ ] Настроить централизованное логирование
- [ ] Настроить метрики (количество запросов, время ответа)
- [ ] Настроить health checks
- [ ] Настроить трейсинг запросов

---

## 7. Обработка ошибок

- [ ] Настроить глобальную обработку ошибок
- [ ] Настроить форматирование ошибок
- [ ] Настроить retry политики
- [ ] Настроить circuit breaker

---

## 8. CORS

- [ ] Настроить CORS политики
- [ ] Настроить разрешенные origins
- [ ] Настроить разрешенные методы и headers

---

## 9. Swagger документация

- [ ] Настроить Swagger для всех сервисов
- [ ] Агрегировать документацию всех сервисов
- [ ] Настроить авторизацию в Swagger

---

## 10. Тестирование

- [ ] Unit тесты для конфигурации
- [ ] Integration тесты для маршрутизации
- [ ] Тесты аутентификации
- [ ] Нагрузочное тестирование

---

## 11. Развертывание

- [ ] Настроить CI/CD pipeline
- [ ] Настроить health checks
- [ ] Подготовить инструкции по развертыванию

---

## Приоритеты

**Высокий:** Настройка, Маршрутизация, Аутентификация, Rate Limiting
**Средний:** Кэширование, Логирование, Обработка ошибок
**Низкий:** Расширенные функции, Агрегация

